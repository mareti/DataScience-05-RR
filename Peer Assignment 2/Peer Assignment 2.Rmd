---
title: "Peer Assignment 2"
output: 
    html_document:
        keep_md: true
---
Muralidhar Areti  
Jul 24, 2015

## Synopsis
The NOAA Storm Database is created from storm data provided by the National Weather Service. This analysis aims to answer the following questions:  

1. Which types of events are most harmful with respect to population health?  
2. Which types of events have the greatest economic consequences?  

To achieve these goals we need to provide the following results:  

* Assessment of data  
    - Number of records per year  
* Top 10 disaster types (overall or specific date range?) by  
    - Fatalities  
    - Injuries  
    - Property Damage  


## Data Processing


### Assumptions


### Initializing the Data

```{r 1.1 Initialize Environment}
suppressPackageStartupMessages(library(dplyr))
library(lubridate)
library(ggplot2)
library(scales)
```

```{r 1.2a Get Data, cache=TRUE, echo=FALSE}
# url = "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
# download.file(url, destfile="./data.csv", method="curl")
# data = read.csv("data.csv")

```

```{r 1.2b Get Data, cache=TRUE}
data = read.csv("repdata-data-StormData.csv")
```

```{r 1.3 Review Data}
print(dim(data))
print(names(data))
# print(str(data))
# print(summary(data))
# print(head(data))
```

## Results


```{r 2.3 Yearly Property Damage Trend}
top_pd = working_data %>%
    group_by(EVTYPE) %>%
    summarize(SumPropertyDamage = sum(PROPDMG)) %>%
    top_n(5) %>% 
    arrange(desc(SumPropertyDamage)) %>%
    select(EVTYPE)

sub_data = inner_join(x=working_data, y=top_pd)

sub_data %>% 
    group_by(bgn_year, EVTYPE) %>%
    summarize(SumPropertyDamage = sum(PROPDMG)) %>%
    ggplot(aes(x=factor(bgn_year), y=SumPropertyDamage, fill=EVTYPE)) + 
    geom_bar(stat="identity") + 
    scale_y_continuous(labels=dollar) +
    scale_fill_brewer() +
    labs(x="Incident Year") + 
    labs(y="Measure Value") + 
    labs(title="Property Damage of the 5 Most Damaging Incidents") +
    theme_bw() +
    theme(axis.text.x = element_text(angle=90, size=10))
```

## Conclusion


End of File